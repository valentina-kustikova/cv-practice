# Практическая работа №3. Классификация изображений с использованием библиотеки OpenCV

## Алгоритм "Мешок слов" для классификации изображений

### Алгоритм обучения:

1. Извлечение локальных признаков со всех обучающих изображений
   - Находим характерные точки на изображении
   - Для каждой точки вычисляем дескриптор (числовой вектор, описывающий локальную область)

2. Пострение словаря визуальных слов
   - Собираем все дескрипторы со всех изображений
   - Кластеризуем дескрипторы на указанное число кластеров
   - Центры кластеров становятся "визуальными словами"

3. Кодирование изображений
   - Для каждого изображения находим, к каким визуальным словам принадлежат его дескрипторы
   - Строим гистограмму частот визуальных слов: сколько дескрипторов попало в каждый кластер, нормализуем её

4. Обучение классификатора
   - Используем полученные гистограммы как признаки для классификатора
   - Обучаем классификатор на этих признаках

### Алгоритм использования:

1. Из каждого нового изображения извлекаем локальные признаки
   - Находим ключевые точки и вычисляем дескрипторы

2. Преобразуем изображение в гистограмму
   - Для каждого дескриптора находим, к каким визуальным словам принадлежат его дескрипторы
   - Строим и нормализуем гистограмму

3. Классифицируем изображение
   - Подаём гистограмму в обученный классификатор для получения предсказания класса

---

## Алгоритм нейронной сети VGG16

### Алгоритм обучения:

1. Подготовка модели для работы с нашими данными
   - Возьмём модель, обученную на ImageNet
   - Убераем последние слои (классификаторы ImageNet)
   - Сделаем все слои неизменяемыми, это позволит использовать уже обученные признаки
   - Добавляем свои слои поверх имеющихся

2. Подготовка данных
   - Преобразуем все изображения к размеру 224x224 пикселей
   - Конвертирем изображения в формат RGB и нормализуем значения пикселей

3. Обучение модели
   - Обучаем добавленные нами в имеющуюся модель слои на наших данных

### Алгоритм использования:

1. Предобработка новых изображени
   - Преобразуем все изображения к размеру 224x224 пикселей
   - Конвертирем изображения в формат RGB и нормализуем значения пикселей

2. Классификация изображения
   - Пропускаем изображение через замороженные и добавленные нами слои
   - Получаем вероятности принадлежности каждого изображения к каждому классу
   - Выбираем класс с максимальной вероятностью
   - Верни предсказание и уверность