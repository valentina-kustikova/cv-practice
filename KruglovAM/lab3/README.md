# Практическая работа №3. Классификация изображений с использованием библиотеки OpenCV

Проект реализует систему классификации изображений с использованием метода Bag of Words, комбинируя извлечение признаков SIFT и классификатор градиентного бустинга. Задача — классификация изображений на две категории: кошки и собаки.

Алгоритм:

1. **Извлечение признаков**: использование метода SIFT для извлечения ключевых признаков из изображений.
2. **Bag of Words**: кластеризация извлеченных признаков с помощью алгоритма K-Means для создания визуального словаря.
3. **Классификация**: использование классификатора GradientBoosting для классификации изображений на основе гистограмм признаков, полученных из визуального словаря.

## Основные алгоритмы

### 1. **SIFT**
Метод, который используется для обнаружения и описания локальных признаков на изображениях. Он работает путем нахождения ключевых точек на изображении, которые инвариантны к масштабу и вращению. Для каждой ключевой точки извлекает дескриптор — вектор, который представляет собой локальную область изображения. Этот дескриптор устойчив к таким трансформациям, как изменение масштаба, вращение и небольшие изменения в перспективе.

### 2. **Кластеризация K-Means для создания визуального словаря**
Извлеченные дескрипторы всех изображений кластеризуются с помощью алгоритма K-Means для создания визуального словаря. Каждый кластер в результате работы алгоритма K-Means представляет собой "визуальное слово", и каждое изображение может быть представлено гистограммой этих визуальных слов.

- Все дескрипторы из всех изображений собираются в один массив.
- Применяется алгоритм K-Means для кластеризации этих дескрипторов с целью формирования `n_clusters` кластеров (по умолчанию используется 100 кластеров).
- Результатом является визуальный словарь, где каждый центр кластера соответствует визуальному слову.

### 3. **Модель Bag of Words (BoW)**
Модель Bag of Words в классификации изображений работает следующим образом: извлекаются дескрипторы признаков, которые затем присваиваются ближайшим кластерам. Гистограмма этих визуальных слов для изображения служит его представлением.

Для каждого изображения:
- Дескрипторы SIFT присваиваются ближайшим центрам кластеров (визуальным словам).
- Строится гистограмма, которая представляет частоту каждого визуального слова в изображении.
- Эта гистограмма становится вектором признаков изображения.

### 4. **Градиентный бустинг**
После вычисления гистограмм BoW для каждого изображения, обучается классификатор градиентного бустинга, используя эти гистограммы как признаки. Классификатор используется для предсказания того, принадлежит ли изображение к категории "кошка" или "собака".

## Обучение и тестирование модели

Модель обучается, загружая изображения из указанной директории, извлекая признаки с помощью SIFT, создавая визуальный словарь с помощью K-Means и обучая классификатор градиентного бустинга на основе полученных гистограмм BoW.
Обученная модель используется для предсказания классов для изображений тестовой выборки. Система проверяет ее точность на наборе тестовых изображений. Предсказанные метки сравниваются с истинными метками, и выводятся различные метрики, такие как матрица рассогласования и точность классификации.

#### Команда:
```bash
python lab3.py -td <путь_к_директории_с_изображениями> -nc <количество_кластеров> -s <Суммарный расмер тестовой и тренировочной выборок> -tp <Отношение размера тестовой выборки к суммарной>
```

## Заключение
Этот проект демонстрирует использование традиционных методов компьютерного зрения (SIFT и Bag of Words) в сочетании с классификатором машинного обучения (KNN и GradientBoosting) для классификации изображений.