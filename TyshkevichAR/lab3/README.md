# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ3. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ OpenCV

### –¢–µ–º–∞:
–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –ù–∏–∂–Ω–µ–≥–æ –ù–æ–≤–≥–æ—Ä–æ–¥–∞ —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞ "–º–µ—à–æ–∫ —Å–ª–æ–≤" (Bag of Visual Words) –∏ –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π (transfer learning).

---

## üéØ –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã
–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Python –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –ù–∏–∂–Ω–µ–≥–æ –ù–æ–≤–≥–æ—Ä–æ–¥–∞:
- **–ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∏–π –ö—Ä–µ–º–ª—å**
- **–î–≤–æ—Ä–µ—Ü —Ç—Ä—É–¥–∞**
- **–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–∏–π —Å–æ–±–æ—Ä**

---

## ‚öôÔ∏è –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø—Ä–æ–≥—Ä–∞–º–º—ã

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:

1. **–ê–ª–≥–æ—Ä–∏—Ç–º ‚Äú–ú–µ—à–æ–∫ —Å–ª–æ–≤‚Äù (BoW + SVM)**
   - –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (SIFT / ORB);
   - –ü—Ä–∏–∑–Ω–∞–∫–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑—É—é—Ç—Å—è –º–µ—Ç–æ–¥–æ–º MiniBatchKMeans;
   - –§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ ‚Äú–≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤‚Äù –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è;
   - –ù–∞ –æ—Å–Ω–æ–≤–µ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º –æ–±—É—á–∞–µ—Ç—Å—è SVM-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä.

2. **–ù–µ–π—Ä–æ—Å–µ—Ç–µ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è (CNN, Transfer Learning)**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å `ResNet18` –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `torchvision.models`;
   - –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–ª–æ–π –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä;
   - –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–µ—Ç–æ–¥—ã **–∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö** (–æ—Ç—Ä–∞–∂–µ–Ω–∏—è, –ø–æ–≤–æ—Ä–æ—Ç—ã, –∏–∑–º–µ–Ω–µ–Ω–∏–µ —è—Ä–∫–æ—Å—Ç–∏);
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

---


---

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### 1Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

- opencv-python
- numpy
- torch
- torchvision
- scikit-learn
- tqdm
- pillow
- joblib

### 2Ô∏è‚É£ –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
üîπ **–í–∞—Ä–∏–∞–Ω—Ç 1 ‚Äî "–ú–µ—à–æ–∫ —Å–ª–æ–≤"**
```bash
python main.py --data_dir ./data --train_file train.txt --test_file test.txt --mode train,test --algo bow --bow_k 200

````
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª model_bow.bz2.

üîπ **–í–∞—Ä–∏–∞–Ω—Ç 2 ‚Äî –ù–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å**
```bash
python main.py --data_dir ./data --train_file train.txt --test_file test.txt --mode train,test --algo cnn --epochs 10 --device cuda

```          
–ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ model_cnn.pth.

–ï—Å–ª–∏ CUDA –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CPU.

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã
–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–≤–æ–¥–∏—Ç:

- Accuracy (—Ç–æ—á–Ω–æ—Å—Ç—å);
- Classification report (precision / recall / F1);
- Confusion matrix (–º–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫).

**–†–µ–∑—É–ª—å—Ç–∞—Ç –∞–ª–≥–æ—Ä–∏—Ç–º–∞ "–ú–µ—à–æ–∫ —Å–ª–æ–≤":**

```
Accuracy: 0.85
              precision    recall  f1-score   support

    arch        1.00        0.93     0.96        27
    krem        0.99        0.99     0.99        69
    palace      0.95        1.00     0.97        35

    accuracy                         0.98        131
```    

**–†–µ–∑—É–ª—å—Ç–∞—Ç –∞–ª–≥–æ—Ä–∏—Ç–º–∞ "–ù–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å":**

```
Accuracy:  1.00
              precision    recall  f1-score   support

   arch         1.00        1.00      1.00       27
   krem         1.00        1.00      1.00       69
   palace       1.00        1.00      1.00       35

   accuracy                           1.00       131
``` 

---

## üß† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- –ö–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –û–û–ü –∏ –º–æ–¥—É–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞.

- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –¥–≤–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∫–ª–∞—Å—Å–∞:

   - BoWClassifier ‚Äî –¥–ª—è ‚Äú–º–µ—à–∫–∞ —Å–ª–æ–≤‚Äù (OpenCV + sklearn)

   - CNNClassifier ‚Äî –¥–ª—è –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π (PyTorch)

- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ä–µ–∂–∏–º train, test –∏–ª–∏ train,test.

- –î–ª—è CNN –¥–æ–±–∞–≤–ª–µ–Ω—ã —É–ª—É—á—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏:

  - Data Augmentation (–ø–æ–≤–æ—Ä–æ—Ç—ã, –æ—Ç—Ä–∞–∂–µ–Ω–∏—è, —è—Ä–∫–æ—Å—Ç—å)
  - Fine-tuning –≤—Å–µ—Ö —Å–ª–æ—ë–≤ ResNet
  - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ ImageNet

