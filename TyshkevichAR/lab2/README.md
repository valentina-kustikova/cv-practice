# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ2. –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ OpenCV

---

## üéØ –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã:
–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –≤–∏–¥–µ–æ–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π –∏–∑ "–∑–æ–æ–ø–∞—Ä–∫–∞" –º–æ–¥–µ–ª–µ–π OpenCV. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å
–∏–µ—Ä–∞—Ä—Ö–∏—é –∫–ª–∞—Å—Å–æ–≤ –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å —Ä–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞ (TPR, FDR) –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –ø—É—Ç–µ–º —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å
—ç—Ç–∞–ª–æ–Ω–Ω–æ–π —Ä–∞–∑–º–µ—Ç–∫–æ–π (Ground Truth) –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.
---

## üñºÔ∏è –û–±–∑–æ—Ä

---

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –Ω–∞ Python –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–¥—Ä–æ–≤ –≤–∏–¥–µ–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π –∏–∑ –º–æ–¥—É–ª—è DNN –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ OpenCV. –û–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–æ–¥–µ–ª–∏ YOLO –∏ SSD –∏–∑ –∑–æ–æ–ø–∞—Ä–∫–∞ –º–æ–¥–µ–ª–µ–π OpenCV, —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –∫–ª–∞—Å—Å—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, car, bus, truck). –°–∫—Ä–∏–ø—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –≤—ã—á–∏—Å–ª—è–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏ (True Positive Rate - TPR –∏ False Discovery Rate - FDR) –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑–º–µ—Ç–∫–∏ ground truth –∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–∞–¥—Ä—ã –≤ –≤–∏–¥–µ –≤–∏–¥–µ–æ–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å bounding boxes, –º–µ—Ç–∫–∞–º–∏ –∫–ª–∞—Å—Å–æ–≤ –∏ —É—Ä–æ–≤–Ω—è–º–∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏.

## üöÄ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

---
- –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤ (—Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è –¥–ª—è –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª–µ–π).
- –ü—Ä–µ–¥- –∏ –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏.
- –û—Ü–µ–Ω–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º IoU-–º–∞—Ç—á–∏–Ω–≥–∞ –¥–ª—è TPR –∏ FDR.
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Å—Ç–∏–ª–µ –≤–∏–¥–µ–æ —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º FPS.


## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

------------

1.  –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash

pip install opencv-python numpy
```
2.  –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –º–æ–¥–µ–ª–∏:
    
```
\# –î–ª—è SSD (MobileNetSSD)
mkdir \-p models/ssd
\# –ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤ models/ssd:
\# - MobileNetSSD\_deploy.caffemodel
\# - MobileNetSSD\_deploy.prototxt
\# - coco.names –∏–ª–∏ ssd\_classes.txt

\# –î–ª—è YOLO
mkdir \-p models/yolo
\# –ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤ models/yolo:
\# - yolov3.weights
\# - yolov3.cfg
\# - coco.names
```
## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

--------------------

```text

lab3/
‚îú‚îÄ‚îÄ script.py                 # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ imgs\_MOV03478/        # –ö–∞–¥—Ä—ã –≤–∏–¥–µ–æ
‚îÇ   ‚îî‚îÄ‚îÄ mov03478.txt          # Ground Truth —Ä–∞–∑–º–µ—Ç–∫–∞
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ ssd/                  # –ú–æ–¥–µ–ª–∏ SSD
‚îÇ   ‚îî‚îÄ‚îÄ yolo/                 # –ú–æ–¥–µ–ª–∏ YOLO
‚îú‚îÄ‚îÄ .venv/                    # –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
‚îî‚îÄ‚îÄ README.md                 # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üéÆ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

----------------

### –ó–∞–ø—É—Å–∫ –º–æ–¥–µ–ª–∏ ssd:

```bash

python script.py --model ssd --model_path models/ssd/MobileNetSSD_deploy.caffemodel --config_path models/ssd/MobileNetSSD_deploy.prototxt --classes_path models/ssd/ssd_classes.txt --images_dir data/imgs_MOV03478 --gt_txt data/mov03478.txt --display --fps 10  
```

### –ó–∞–ø—É—Å–∫ –º–æ–¥–µ–ª–∏ Yolo v3:

```bash

python script.py --model yolo --model_path models/yolo/yolov3.weights --config_path models/yolo/yolov3.cfg --classes_path models/yolo/coco.names --images_dir data/imgs_MOV03478 --gt_txt data/mov03478.txt --display --fps 30   
```

## üìä –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

-----------------------------

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
| ------- | ------- | ------- |
| --model | –ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –º–æ–¥–µ–ª—å (yolo¬†–∏–ª–∏¬†ssd) | –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π |
| --model_path | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏ | –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π |
| --config_path | –ü—É—Ç—å –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º—É —Ñ–∞–π–ª—É –º–æ–¥–µ–ª–∏ | –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π |
| --classes_path | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å –∏–º–µ–Ω–∞–º–∏ –∫–ª–∞—Å—Å–æ–≤ | coco.names |
| --images_dir | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ | data/imgs_MOV03478 |
| --gt_txt | –§–∞–π–ª —Å Ground Truth —Ä–∞–∑–º–µ—Ç–∫–æ–π | data/mov03478.txt |
| --display | –§–ª–∞–≥ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–∏–¥–µ–æ | False |
| --fps | FPS –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–∏–¥–µ–æ | 30 |

## üìù –§–æ—Ä–º–∞—Ç Ground Truth

----------------------

–§–∞–π–ª Ground Truth –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —Ñ–æ—Ä–º–∞—Ç:

```text

<frame\_id> <class\_name> <x1> <y1> <x2> <y2>
```
**–ü—Ä–∏–º–µ—Ä:**

```text

0 car 100 200 300 400
0 car 500 600 700 800
1 bus 150 250 350 450
```
–ì–¥–µ:

*   `frame_id`¬†- –Ω–æ–º–µ—Ä –∫–∞–¥—Ä–∞ (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 0)
    
*   `class_name`¬†- –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞ (–≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ)
    
*   `x1, y1`¬†- –ª–µ–≤—ã–π –≤–µ—Ä—Ö–Ω–∏–π —É–≥–æ–ª
    
*   `x2, y2`¬†- –ø—Ä–∞–≤—ã–π –Ω–∏–∂–Ω–∏–π —É–≥–æ–ª
    

## ü§ñ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–æ–¥–µ–ª–∏

------------------------

### 1.¬†**SSD (MobileNetSSD)**

*   **–¢–∏–ø**: Caffe –º–æ–¥–µ–ª—å
    
*   **–í—Ö–æ–¥–Ω–æ–π —Ä–∞–∑–º–µ—Ä**: 300x300
    
*   **–ö–ª–∞—Å—Å—ã**: 21 –∫–ª–∞—Å—Å (–≤–∫–ª—é—á–∞—è —Ñ–æ–Ω)
    
*   **–°–∫–æ—Ä–æ—Å—Ç—å**: –ë—ã—Å—Ç—Ä–∞—è, —Ö–æ—Ä–æ—à–∞ –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
    
*   **–¢–æ—á–Ω–æ—Å—Ç—å**: –•–æ—Ä–æ—à–∞—è –¥–ª—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤
    

### 2.¬†**YOLO (YOLOv3)**

*   **–¢–∏–ø**: Darknet –º–æ–¥–µ–ª—å
    
*   **–í—Ö–æ–¥–Ω–æ–π —Ä–∞–∑–º–µ—Ä**: 416x416
    
*   **–ö–ª–∞—Å—Å—ã**: 80 –∫–ª–∞—Å—Å–æ–≤ COCO
    
*   **–¢–æ—á–Ω–æ—Å—Ç—å**: –í—ã—Å–æ–∫–∞—è, –ª—É—á—à–µ –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤
    
*   **–°–∫–æ—Ä–æ—Å—Ç—å**: –ú–µ–¥–ª–µ–Ω–Ω–µ–µ SSD
    

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –æ—Ü–µ–Ω–∫–∏

-----------------

### **TPR (True Positive Rate)**

```text

TPR = TP / (TP + FN)
```
*   **–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç**: –ö–∞–∫—É—é –¥–æ–ª—é —Ä–µ–∞–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞—à–ª–∞ —Å–∏—Å—Ç–µ–º–∞
    
*   **–•–æ—Ä–æ—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è**: >0.7
    
*   **–û—Ç–ª–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**: >0.8
    

### **FDR (False Discovery Rate)**

```text

FDR = FP / (TP + FP)
```
*   **–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç**: –ö–∞–∫—É—é –¥–æ–ª—é –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è
    
*   **–•–æ—Ä–æ—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è**: <0.1
    
*   **–û—Ç–ª–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**: <0.05
    

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–æ–¥–µ–ª–∏ ssd:**

```text

TPR: 0.744  # –ù–∞–π–¥–µ–Ω–æ 80.4% —Ä–µ–∞–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
FDR: 0.025  # –¢–æ–ª—å–∫–æ 4% –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π
```

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º–æ–¥–µ–ª–∏ yolo:**

```text

TPR: 0.936  # –ù–∞–π–¥–µ–Ω–æ 93.6% —Ä–µ–∞–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
FDR: 0.158  # –¢–æ–ª—å–∫–æ 15% –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π
```

## üñºÔ∏è –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

----------------

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ñ–ª–∞–≥–∞¬†`--display`:

*   **–ó–µ–ª–µ–Ω—ã–µ —Ä–∞–º–∫–∏**: –ù–∞–π–¥–µ–Ω–Ω—ã–µ –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–º –æ–±—ä–µ–∫—Ç—ã
    
*   **–°–∏–Ω–∏–µ —Ä–∞–º–∫–∏**: Ground Truth –æ–±—ä–µ–∫—Ç—ã
    
*   **–ù–∞–¥–ø–∏—Å–∏**: –ö–ª–∞—Å—Å –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–∏
    

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

*   `Q`¬†- –≤—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã

