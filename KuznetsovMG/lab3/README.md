# Практическая работа №3. Классификация изображений с использованием OpenCV и SVM

**Цель работы:**  
Разработать приложение для классификации изображений из набора данных dogs-vs-cats с применением алгоритма "мешок слов". Программа извлекает SIFT-дескрипторы, группирует их с помощью KMeans для создания визуального словаря и обучает модель SVC для предсказания классов.

## Описание

Программа обрабатывает изображения, классифицируя их в две категории: кошки и собаки. Метки классов определяются по именам файлов:
- В обучающей выборке имена должны начинаться с `cat` или `dog`.
- В тестовой выборке имена файлов представлены в виде чисел (первая сотня – кошки, последующие – собаки).

## Ключевые моменты реализации

- **Обработка параметров командной строки:**  
  Функция `extract_arguments()` считывает следующие аргументы:
  - `-tr` / `--train_dir` – директория с обучающими изображениями.
  - `-te` / `--test_dir` – директория с тестовыми изображениями.
  - `-c` / `--num_clusters` – количество кластеров для построения визуального словаря.

- **Загрузка и обработка изображений:**  
  Функция `fetch_images(dir_path)` загружает изображения из указанной папки и изменяет их размер до 256x256 пикселей.

- **Извлечение меток классов:**  
  Функции `fetch_train_labels(dir_path)` и `fetch_test_labels(dir_path)` получают метки классов на основании имен файлов в обучающем и тестовом наборах соответственно.

- **Извлечение SIFT-дескрипторов:**  
  Функция `extract_sift_features(images)` обрабатывает каждое изображение для получения ключевых дескрипторов с использованием SIFT.

- **Построение визуального словаря:**  
  С помощью функции `build_visual_dictionary(descriptors_list, clusters)` все дескрипторы объединяются, и алгоритм KMeans группирует их в заданное число кластеров.

- **Формирование векторов признаков:**  
  Функция `compute_feature_histograms(descriptors_list, kmeans_model, clusters)` создаёт для каждого изображения гистограмму распределения дескрипторов по кластерам, которая впоследствии используется в качестве признакового вектора.

- **Обучение и оценка модели:**  
  Модель SVC (Support Vector Classifier) обучается на признаках обучающей выборки. После обучения производится предсказание для тестовых данных, выводится отчёт по метрикам классификации и строится матрица ошибок.

- **Обработка графики:**  
  Если модуль `tkinter` отсутствует, приложение использует неинтерактивный backend `Agg` и сохраняет график матрицы ошибок в файл `confusion_matrix.png`.

## Пример запуска

```sh
python main.py -te test -tr train -c 10
```

Приложение автоматически считает изображения, извлечёт признаки, обучит модель и выведет результаты классификации.
