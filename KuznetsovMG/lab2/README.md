# Практическая работа №2. Детектирование объектов на изображениях с использованием библиотеки OpenCV

**Задача.** Разработать приложение для детектирования объектов с использованием обученной нейронной сети YOLOv3.

## Описание
Реализовано приложение для детектирования объектов с использованием обученной нейронной сети YOLOv3.

### Описание ключевых аспектов программы

#### Структура программы
- Для инициализации (загрузки) сети используется метод `load_resources()`, опишем его основные этапы:
  1. Загружается модель в OpenCV с помощью функции `cv2.dnn.readNet()`. Для загрузки модели используются файлы, содержащие веса и конфигурацию модели.
  2. Получение имен выходных слоев модели с помощью функций `cv2.dnn_Net.getLayerNames()` и `cv2.dnn_Net.getUnconnectedOutLayers()`, они нам понадобятся для корректного интерпретирования выхода нейронной сети.
  3. Получение названий всех классов, которые мы можем обнаружить.
  Для того, чтобы эти действия сработали, необходимо иметь в той же директории, что и `main.py`, файлы `yolov3.cfg`, `yolov3.weights` и `coco.names`.

- Метод `process()` является отправной точкой в программе, он подготавливает изображение, прогоняет его через нейронную сеть (прямое распространение через сеть), а также использует другие методы для анализа результатов и отображения их пользователю.

- Метод `detect_objects()` для всех выходов сети проводит следующий анализ:
  - Во-первых, отсеивает выходы, значение confidence которых меньше выставляемого пользователем порога.
  - Во-вторых, для тех, кто не был отсеян, приводит данные в удобный вид.

- Метод `visualize_detections()` отображает итоговое изображение пользователю и выводит статистику в консоль.

#### Используемые алгоритмы
1. Алгоритм не-максимального подавления (NMS, Non-Maximum Suppression)
   Используется для того, чтобы отфильтровать перекрывающиеся ограниченные рамки, которые предсказывают один и тот же объект.

### Описание аргументов командной строки
Доступны следующие аргументы:
- `-i` или `--image` — путь к изображению.
- `-m` или `--model` — путь к файлу весов модели.
- `-conf` или `--configuration` — путь к файлу конфигурации.
- `-l` или `--labels` — путь к файлу с названиями классов.
- `-t` или `--threshold` — установление порога уверенности сети в изображении, если порог ниже чем указанный, то мы не будем учитывать данный выход сети. По умолчанию 0.5, тип — `float`.
- `-iou` или `--iou-threshold` — установление порога немаксимального подавления. По умолчанию 0.4, тип — `float`.
- `-r` или `--result` — путь для сохранения результата.
- `-d` или `--display` — отобразить результат в окне.

### Пример запуска
```sh
path/to/python main.py -i picture.jpg -m yolov3.weights -conf yolov3.cfg -l coco.names -t 0.8 -iou 0.6
```
