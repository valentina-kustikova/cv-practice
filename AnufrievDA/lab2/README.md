# Практическая работа №2. Детектирование объектов на изображениях с использованием библиотеки OpenCV

**Выполнил:** Ануфриев Даниил

## Описание решения
Разработано приложение на языке Python для детекции транспортных средств (классы `car`, `bus`) на видеопотоке. 
Архитектура приложения построена на принципах ООП:
- `ObjectDetector`: Базовый абстрактный класс, определяющий интерфейс.
- `SSDMobileNet`, `YOLOv4`, `FasterRCNN`: Классы-наследники, реализующие специфику каждой модели.
- `dataset_loader`: Модуль для чтения и парсинга аннотаций (Ground Truth).
- `performance_metrics`: Модуль для расчета метрик качества (IoU, TPR, FDR).

## Используемые модели и алгоритмы

### 1. SSD MobileNet V2
- **Источник:** TensorFlow Object Detection Model Zoo.
- **Предобработка:** Изменение размера изображения до **300x300**, конвертация в blob.
- **Постобработка:** Фильтрация по `confidence_threshold`, отсечение классов, не относящихся к транспорту.

### 2. YOLO v4-tiny
- **Источник:** Darknet (AlexeyAB).
- **Предобработка:** Изменение размера до **416x416**, нормализация значений пикселей (scale 1/255).
- **Постобработка:** Декодирование выходов YOLO, применение Non-Maximum Suppression (NMS) для удаления дублирующихся рамок.

### 3. Faster R-CNN (ResNet50)
- **Источник:** TensorFlow Object Detection Model Zoo.
- **Предобработка:** Использование оригинального размера изображения (сеть адаптивна).
- **Постобработка:** Фильтрация по уверенности модели.

## Результаты сравнения

Метрики рассчитывались на основе IoU (Intersection over Union) с порогом 0.5.

| Модель | TPR (Recall) | FDR (False Discovery Rate) | TP | FP | FN |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **SSD MobileNet V2** | 0.4973 | **0.0255** | 10092 | 264 | 10200 |
| **YOLO v4-tiny** | 0.8551 | 0.0766 | 17352 | 1439 | 2940 |
| **Faster R-CNN** | **0.8971** | 0.1721 | 18203 | 3785 | 2089 |

### Выводы
1. **SSD MobileNet** показала наименьшее количество ложных срабатываний (FDR ~2.5%), но пропустила значительное количество объектов (TPR ~50%). Подходит для задач, где критична скорость и отсутствие ложных тревог.
2. **Faster R-CNN** обнаружила наибольшее количество объектов (TPR ~90%), но имеет высокий уровень шума (FDR ~17%) и работает медленнее остальных.
3. **YOLO v4-tiny** продемонстрировала оптимальный баланс между полнотой обнаружения и точностью, являясь предпочтительным выбором для данной задачи.

## Запуск приложения

Пример запуска для модели YOLO:
```bash
python run.py --model yolo --img_dir data/images --gt data/annotations.txt --show
```

Аргументы:
- `--model`: выбор модели (`ssd`, `yolo`, `rcnn`).
- `--img_dir`: путь к папке с изображениями.
- `--gt`: путь к файлу разметки.
- `--show`: (опционально) визуализация процесса детекции.