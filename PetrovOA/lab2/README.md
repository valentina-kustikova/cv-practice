# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ2. –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ OpenCV

## –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ (CAR, BUS) –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–æ–¥—É–ª—è `cv2.dnn` –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ OpenCV. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏–µ—Ä–∞—Ä—Ö–∏—è –∫–ª–∞—Å—Å–æ–≤ –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ç—Ä—ë—Ö —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
lab2/
‚îú‚îÄ‚îÄ main.py              # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ detectors.py         # –ò–µ—Ä–∞—Ä—Ö–∏—è –∫–ª–∞—Å—Å–æ–≤ –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤
‚îú‚îÄ‚îÄ download_models.py   # –°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ analyze_labels.py    # –ê–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–∞ —Ä–∞–∑–º–µ—Ç–∫–∏
‚îú‚îÄ‚îÄ labels.txt           # Ground truth —Ä–∞–∑–º–µ—Ç–∫–∞
‚îú‚îÄ‚îÄ data/                # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
‚îú‚îÄ‚îÄ models/              # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –º–æ–¥–µ–ª–µ–π (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îî‚îÄ‚îÄ README.md            # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- OpenCV 4.5+ —Å –º–æ–¥—É–ª–µ–º DNN
- NumPy

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```bash
pip install opencv-python numpy
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

```bash
python download_models.py
```

–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–∫–∞—á–∞—Ç—å –≤—Å–µ).

### 2. –ó–∞–ø—É—Å–∫ –¥–µ—Ç–µ–∫—Ü–∏–∏

```bash
# YOLOv8l
python main.py --data_path ./data --labels_path labels.txt --model yolov8 --model_path models/yolov8l.onnx --show --max_frames 50

# SSD MobileNet V1
python main.py --data_path ./data --labels_path labels.txt --model ssd --model_path models/ssd_mobilenet_v1_coco_2017_11_17/frozen_inference_graph.pb --config_path models/ssd_mobilenet_v1_coco.pbtxt --show --max_frames 50

# NanoDet-Plus
python main.py --data_path ./data --labels_path labels.txt --model nanodet --model_path models/nanodet-plus-m_416.onnx --show --max_frames 50
```

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π |
|----------|----------|--------------|
| `--data_path` | –ü—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ | –î–∞ |
| `--labels_path` | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Ä–∞–∑–º–µ—Ç–∫–∏ | –î–∞ |
| `--model` | –ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ (yolov8, ssd, nanodet) | –î–∞ |
| `--model_path` | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –º–æ–¥–µ–ª–∏ | –î–∞ |
| `--config_path` | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–¥–ª—è SSD) | –î–ª—è SSD |
| `--confidence` | –ü–æ—Ä–æ–≥ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0.5) | –ù–µ—Ç |
| `--nms_threshold` | –ü–æ—Ä–æ–≥ NMS (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0.4) | –ù–µ—Ç |
| `--iou_threshold` | –ü–æ—Ä–æ–≥ IoU –¥–ª—è –º–µ—Ç—Ä–∏–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0.5) | –ù–µ—Ç |
| `--show` | –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∫–∞–¥—Ä—ã —Å –¥–µ—Ç–µ–∫—Ü–∏—è–º–∏ | –ù–µ—Ç |
| `--save_output` | –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ | –ù–µ—Ç |
| `--max_frames` | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–¥—Ä–æ–≤ | –ù–µ—Ç |
| `--random` | –í—ã–±–∏—Ä–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–µ –∫–∞–¥—Ä—ã –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ | –ù–µ—Ç |

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ

- **Q** ‚Äî –≤—ã—Ö–æ–¥
- **–ü—Ä–æ–±–µ–ª** ‚Äî –ø–∞—É–∑–∞/–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ

---

## –û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

### 1. YOLOv8l (You Only Look Once v8 Large)

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** One-stage anchor-free –¥–µ—Ç–µ–∫—Ç–æ—Ä

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –†–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏: ~87 MB
- –í—Ö–æ–¥–Ω–æ–π —Ä–∞–∑–º–µ—Ä: 640√ó640
- –§–æ—Ä–º–∞—Ç: ONNX
- –î–∞—Ç–∞—Å–µ—Ç: COCO (80 –∫–ª–∞—Å—Å–æ–≤)

#### –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

1. **Letterbox resize** ‚Äî –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –¥–æ 640√ó640:
   ```python
   scale = min(640 / width, 640 / height)
   new_size = (int(width * scale), int(height * scale))
   # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ —Ü–µ–Ω—Ç—Ä —Å–µ—Ä–æ–≥–æ —Ö–æ–ª—Å—Ç–∞ 640√ó640
   ```

2. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è** ‚Äî –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –ø–∏–∫—Å–µ–ª–µ–π –∫ –¥–∏–∞–ø–∞–∑–æ–Ω—É [0, 1]:
   ```python
   blob = image / 255.0
   ```

3. **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ü–≤–µ—Ç–æ–≤** ‚Äî BGR ‚Üí RGB

4. **–¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî HWC ‚Üí CHW (Height, Width, Channels ‚Üí Channels, Height, Width)

#### –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã—Ö–æ–¥–∞ —Å–µ—Ç–∏

1. **–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–∞:** `[1, 84, 8400]` –≥–¥–µ:
   - 84 = 4 (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã bbox: cx, cy, w, h) + 80 (scores –∫–ª–∞—Å—Å–æ–≤ COCO)
   - 8400 = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ anchor points (20√ó20 + 40√ó40 + 80√ó80) √ó 3 —É—Ä–æ–≤–Ω—è FPN

2. **–¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** `[1, 84, 8400]` ‚Üí `[8400, 84]`

3. **–î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ bbox:**
   ```python
   x1 = cx - w/2
   y1 = cy - h/2
   x2 = cx + w/2
   y2 = cy + h/2
   ```

4. **–û–±—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç:**
   ```python
   x = (x - pad_x) / scale
   y = (y - pad_y) / scale
   ```

5. **Non-Maximum Suppression (NMS):**
   - IoU threshold: 0.4
   - –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –¥–µ—Ç–µ–∫—Ü–∏–π

---

### 2. SSD MobileNet V1 (Single Shot MultiBox Detector)

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** One-stage anchor-based –¥–µ—Ç–µ–∫—Ç–æ—Ä —Å backbone MobileNet V1

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –†–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏: ~29 MB
- –í—Ö–æ–¥–Ω–æ–π —Ä–∞–∑–º–µ—Ä: 300√ó300
- –§–æ—Ä–º–∞—Ç: TensorFlow (.pb + .pbtxt)
- –î–∞—Ç–∞—Å–µ—Ç: COCO (90 –∫–ª–∞—Å—Å–æ–≤)

#### –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

1. **Resize** ‚Äî –ø—Ä–æ—Å—Ç–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ 300√ó300:
   ```python
   blob = cv2.resize(image, (300, 300))
   ```

2. **–ë–µ–∑ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏** ‚Äî –º–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏—è—Ö [0, 255]

3. **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ü–≤–µ—Ç–æ–≤** ‚Äî BGR ‚Üí RGB

#### –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã—Ö–æ–¥–∞ —Å–µ—Ç–∏

1. **–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–∞:** `[1, 1, N, 7]` –≥–¥–µ:
   - N = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ç–µ–∫—Ü–∏–π
   - 7 = [batch_id, class_id, confidence, x1, y1, x2, y2]

2. **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω [0, 1]

3. **–î–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:**
   ```python
   x1 = detection[3] * image_width
   y1 = detection[4] * image_height
   x2 = detection[5] * image_width
   y2 = detection[6] * image_height
   ```

4. **NMS —É–∂–µ –ø—Ä–∏–º–µ–Ω—ë–Ω –≤–Ω—É—Ç—Ä–∏ –º–æ–¥–µ–ª–∏** ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

---

### 3. NanoDet-Plus

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –£–ª—å—Ç—Ä–∞-–ª—ë–≥–∫–∏–π one-stage anchor-free –¥–µ—Ç–µ–∫—Ç–æ—Ä

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –†–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏: ~2.4 MB
- –í—Ö–æ–¥–Ω–æ–π —Ä–∞–∑–º–µ—Ä: 416√ó416
- –§–æ—Ä–º–∞—Ç: ONNX
- –î–∞—Ç–∞—Å–µ—Ç: COCO (80 –∫–ª–∞—Å—Å–æ–≤)

#### –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

1. **Letterbox resize** ‚Äî –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ YOLOv8, –¥–æ 416√ó416

2. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º mean –∏ std:
   ```python
   mean = [103.53, 116.28, 123.675]
   std = [57.375, 57.12, 58.395]
   image = (image - mean) / std
   ```

3. **–ü–æ—Ä—è–¥–æ–∫ –∫–∞–Ω–∞–ª–æ–≤:** BGR (–±–µ–∑ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏)

4. **–¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** HWC ‚Üí CHW

#### –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã—Ö–æ–¥–∞ —Å–µ—Ç–∏

1. **–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–∞:** `[1, 3598, 112]` –≥–¥–µ:
   - 3598 = —Å—É–º–º–∞ anchor points —Å —Ç—Ä—ë—Ö —É—Ä–æ–≤–Ω–µ–π FPN (52√ó52 + 26√ó26 + 13√ó13)
   - 112 = 80 (–∫–ª–∞—Å—Å—ã) + 32 (4 √ó 8 –¥–ª—è GFL bbox)

2. **GFL (Generalized Focal Loss) –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   ```python
   # –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã bbox (left, top, right, bottom):
   # 8 –∑–Ω–∞—á–µ–Ω–∏–π –æ–ø–∏—Å—ã–≤–∞—é—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
   distribution = softmax(bbox_pred[0:8])
   offset = sum(distribution * [0, 1, 2, 3, 4, 5, 6, 7])
   ```

3. **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:**
   ```python
   x1 = anchor_x - left * stride
   y1 = anchor_y - top * stride
   x2 = anchor_x + right * stride
   y2 = anchor_y + bottom * stride
   ```

4. **Multi-scale anchor points:**
   - Stride 8: 52√ó52 = 2704 —Ç–æ—á–µ–∫
   - Stride 16: 26√ó26 = 676 —Ç–æ—á–µ–∫
   - Stride 32: 13√ó13 = 169 —Ç–æ—á–µ–∫

5. **NMS** –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –¥–µ—Ç–µ–∫—Ü–∏–π

---

## –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### TPR (True Positive Rate) ‚Äî –ü–æ–ª–Ω–æ—Ç–∞

$$TPR = \frac{TP}{TP + FN}$$

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–æ–ª—é –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Ä–∞–∑–º–µ—Ç–∫–µ.

### FDR (False Discovery Rate) ‚Äî –î–æ–ª—è –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π

$$FDR = \frac{FP}{TP + FP}$$

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–æ–ª—é –ª–æ–∂–Ω—ã—Ö –¥–µ—Ç–µ–∫—Ü–∏–π —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö –¥–µ—Ç–µ–∫—Ü–∏–π –º–æ–¥–µ–ª–∏.

### Matching –¥–µ—Ç–µ–∫—Ü–∏–π —Å ground truth

–î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è TP/FP/FN –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è IoU (Intersection over Union):

$$IoU = \frac{Area_{intersection}}{Area_{union}}$$

–î–µ—Ç–µ–∫—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è True Positive –µ—Å–ª–∏:
1. IoU —Å ground truth box ‚â• 0.5
2. –ö–ª–∞—Å—Å –¥–µ—Ç–µ–∫—Ü–∏–∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–ª–∞—Å—Å–æ–º ground truth
3. Ground truth box –µ—â—ë –Ω–µ –±—ã–ª —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω

---

## –ò–µ—Ä–∞—Ä—Ö–∏—è –∫–ª–∞—Å—Å–æ–≤

```
BaseDetector (ABC)
    ‚îú‚îÄ‚îÄ preprocess(image) -> blob
    ‚îú‚îÄ‚îÄ postprocess(outputs, shape) -> List[Detection]
    ‚îú‚îÄ‚îÄ detect(image) -> List[Detection]
    ‚îî‚îÄ‚îÄ name -> str
         ‚îÇ
         ‚îú‚îÄ‚îÄ YOLOv8Detector
         ‚îÇ       ‚îî‚îÄ‚îÄ ONNX, letterbox, anchor-free
         ‚îÇ
         ‚îú‚îÄ‚îÄ SSDMobileNetDetector
         ‚îÇ       ‚îî‚îÄ‚îÄ TensorFlow, resize 300x300, anchor-based
         ‚îÇ
         ‚îî‚îÄ‚îÄ NanoDetPlusDetector
                 ‚îî‚îÄ‚îÄ ONNX, letterbox, GFL decoding
```

### –§–∞–±—Ä–∏—á–Ω—ã–π –º–µ—Ç–æ–¥

```python
from detectors import create_detector

detector = create_detector(
    model_name='yolov8',
    model_path='models/yolov8l.onnx',
    confidence_threshold=0.5,
    nms_threshold=0.4
)

detections = detector.detect(image)
```

---

## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

- **–°–ø–ª–æ—à–Ω—ã–µ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∏** ‚Äî –¥–µ—Ç–µ–∫—Ü–∏–∏ –º–æ–¥–µ–ª–∏
- **–ü—É–Ω–∫—Ç–∏—Ä–Ω—ã–µ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∏** ‚Äî ground truth —Ä–∞–∑–º–µ—Ç–∫–∞
- **–¶–≤–µ—Ç–∞:**
  - üü¢ –ó–µ–ª—ë–Ω—ã–π ‚Äî CAR
  - üîµ –°–∏–Ω–∏–π ‚Äî BUS

–í –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É –∫–∞–∂–¥–æ–≥–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è:
- –ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞
- –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (confidence) —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é 3 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ –Ω–∞ 500 —Å–ª—É—á–∞–π–Ω—ã—Ö –∫–∞–¥—Ä–∞—Ö –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞.

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã:** Intel Core i5-12400F, DDR4 32GB, OpenCV 4.11.0 (CPU)

### –ü–æ—Ä–æ–≥ confidence = 0.5 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

| –ú–æ–¥–µ–ª—å | –†–∞–∑–º–µ—Ä | –í—Ä–µ–º—è/–∫–∞–¥—Ä | FPS | TPR | FDR |
|--------|--------|------------|-----|-----|-----|
| YOLOv8l | 166.8 MB | 415.0 –º—Å | 2.41 | 94.32% | 23.92% |
| SSD MobileNet V1 | 27.8 MB | 11.8 –º—Å | 84.63 | 52.54% | 0.86% |
| NanoDet-Plus | 4.6 MB | 71.4 –º—Å | 14.00 | 89.03% | 10.31% |

### –ü–æ–¥–æ–±—Ä–∞–Ω–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ confidence

–î–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è FDR (–ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π) —É —Ç–æ—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∏ –ø–æ–≤—ã—à–µ–Ω–∏—è TPR —É –±—ã—Å—Ç—Ä—ã—Ö –º–æ–¥–µ–ª–µ–π –±—ã–ª–∏ –ø–æ–¥–æ–±—Ä–∞–Ω—ã –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –ø–æ—Ä–æ–≥–∏:

| –ú–æ–¥–µ–ª—å | Confidence | –í—Ä–µ–º—è/–∫–∞–¥—Ä | FPS | TPR | FDR |
|--------|------------|------------|-----|-----|-----|
| YOLOv8l | 0.7 | 434.8 –º—Å | 2.30 | 87.42% | 18.44% |
| SSD MobileNet V1 | 0.4 | 12.7 –º—Å | 78.60 | 63.23% | 2.64% |
| NanoDet-Plus | 0.6 | 70.8 –º—Å | 14.13 | 74.03% | 3.43% |
| NanoDet-Plus | 0.55 | 70.9 –º—Å | 14.11 | 83.67% | 6.32% |

### –ê–Ω–∞–ª–∏–∑ –≤–ª–∏—è–Ω–∏—è –ø–æ—Ä–æ–≥–∞ confidence

| –ú–æ–¥–µ–ª—å | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞ | Œî TPR | Œî FDR | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|--------|------------------|-------|-------|-------------|
| YOLOv8l | 0.5 ‚Üí 0.7 | ‚àí6.9% | ‚àí5.5% | –ú–µ–Ω—å—à–µ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π |
| SSD MobileNet V1 | 0.5 ‚Üí 0.4 | +10.7% | +1.8% | –ë–æ–ª—å—à–µ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞—Ö–æ–¥–∏—Ç |
| NanoDet-Plus | 0.5 ‚Üí 0.6 | ‚àí15.0% | ‚àí6.9% | –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ FDR |

**–í—ã–≤–æ–¥:** –í—ã–±–æ—Ä –ø–æ—Ä–æ–≥–∞ confidence ‚Äî —ç—Ç–æ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É TPR –∏ FDR. –î–ª—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–æ–¥–±–∏—Ä–∞—Ç—å –ø–æ—Ä–æ–≥ –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞—á–µ—Å—Ç–≤—É –¥–µ—Ç–µ–∫—Ü–∏–∏.

---

## –ê–≤—Ç–æ—Ä

–ü–µ—Ç—Ä–æ–≤ –û.–ê.

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
