# Практическая работа №3. Классификация изображений с использованием библиотеки OpenCV

## Реализованные алгоритмы

### Алгоритм "Мешок слов"
1. **Извлечение локальных признаков**: Используются детекторы SIFT, ORB и AKAZE для нахождения ключевых точек и вычисления дескрипторов.
2. **Построение словаря визуальных слов**: Все дескрипторы кластеризуются методом K-means, центры кластеров становятся визуальными словами.
3. **Кодирование изображений**: Каждое изображение представляется в виде гистограммы частот визуальных слов.
4. **Классификация**: На гистограммах обучается классификатор (SVM или Random Forest).

### Сверточная нейронная сеть (Transfer Learning)
1. **Использование предобученной модели**: Берется модель VGG16, обученная на ImageNet.
2. **Заморозка базовых слоев**: Веса предобученных слоев фиксируются для использования уже обученных признаков.
3. **Добавление своих слоев**: Поверх базовой модели добавляются полносвязные слои для классификации трех классов.
4. **Дообучение**: Обучаются только добавленные слои на нашем датасете.

## Использование

### Основные параметры
- `--data_dir`: Путь к директории с данными
- `--train_file`, `--test_file`: Файлы разбиения на выборки
- `--algorithm`: `bow` или `cnn`
- `--mode`: `train`, `test`, `both`, `visualize`
- `--clusters`: Количество кластеров для BOW
- `--detector`: Тип детектора (`sift`, `orb`, `akaze`)
- `--epochs`, `--batch_size`: Параметры обучения CNN
- `--image_size`: Размер входных изображений

### Примеры команд
```bash
# Визуализация SIFT-дескрипторов
python scripts/main.py --mode visualize --image_path путь/к/изображению.jpg --detector sift

# Обучение и тестирование BOW
python scripts/main.py --mode both --algorithm bow --clusters 200 --detector sift

# Обучение и тестирование CNN
python scripts/main.py --mode both --algorithm cnn --epochs 10 --batch_size 8

# Тестирование на одном изображении
python scripts/main.py --mode single --algorithm cnn --image_path путь/к/изображению.jpg
