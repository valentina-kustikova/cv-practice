# Практическая работа №3. Классификация изображений с использованием библиотеки OpenCV
Реализованы два различных подходов к классификации изображений: метод Bag of Words (BoW) и подход на основе нейронных сетей с использованием трансферного обучения. Задача заключалась в классификации изображений из набора данных с целью достижения высокой точности в распознавании нескольких классов. 
### Подход Bag of Words

Метод BoW преобразует изображения в представление на основе визуальных слов. 
1. **Загрузка и предобработка изображений**:
    - Изображения загружались из структуры каталогов, содержащей две подкаталоги, ExtDataset и NNSUDataset, с подкаталогами, соответствующими классам. Была разработана функция `load_images_from_split` для чтения путей к изображениям из файлов `train.txt` и `test.txt`, разделяя набор данных на обучающую и тестовую выборки. Изображения считывались с помощью OpenCV (cv2.imread) и сохранялись вместе с целочисленными метками, полученными из названий подкаталогов.
2. **Извлечение признаков**:
    - Алгоритм Scale-Invariant Feature Transform (SIFT), реализованный через `cv2.SIFT_create()`, использовался для обнаружения ключевых точек и извлечения дескрипторов из преобразованных в градации серого изображений. Функция extract_sift_features проходила по каждому изображению, применяя detectAndCompute для генерации списка дескрипторов.
3. **Построение словаря**:
    - Дескрипторы из всех обучающих изображений агрегировались в единую матрицу с помощью `np.vstack`. Визуальный словарь создавался с использованием MiniBatchKMeans из sklearn.cluster с 500 кластерами (k=500) для представления визуальных слов.
4. **Генерация гистограмм**:
    - Для каждого изображения дескрипторы присваивались ближайшим центроидам с помощью kmeans.predict, и вычислялась гистограмма частот слов с использованием np.histogram. Это дало вектор фиксированной длины для каждого изображения - представления, на котором обучалась модель
5. **Классификация**:
    - Векторы признаков стандартизировались с помощью StandardScaler и классифицировались с использованием машины опорных векторов. Данный классификатор показал на тестовой выборке лучшие результаты классификации. 
### Подход на основе нейронных сетей

Подход с использованием нейронных сетей применял трансферное обучение с следующей реализацией:

1. **Подготовка данных**:
    - Изображения загружались аналогично подходу BoW. Функция load_images_from_split предоставляла обучающую и валидационную выборки. Изображения изменяли размер до 224x224 пикселей.
2. **Архитектура модели**:
    - Предобученная модель VGG импортировалась из tensorflow.keras.applications с исключением классификационных слоев. Все слои были заморожены для сохранения предобученных весов. Были добавлены пользовательские слои: слой GlobalAveragePooling2D, слой Dense с 128 нейронами и активацией ReLU, а также финальный слой Dense с функцией активации softmax для 3 классов.
3. **Обучение**:
    - Модель компилировалась с оптимизатором Adam и функцией потерь sparse_categorical_crossentropy. Обучение проводилось с помощью model.fit с размером батча 32 и 5 эпохами, используя tf.data.Dataset для эффективной обработки данных с перемешиванием.
### Результаты
Подход, использующий Bag of visual words достиг метрик:
- Accuracy:  1.0
- TPR:  1.0

А использование нейронной сети дало значение показателей:
- Accuracy:  0.955
- TPR:  0.933
