# Практическая работа №2. Детектирование объектов на изображениях с использованием библиотеки OpenCV

## Описание проекта

Данный проект реализует систему детектирования транспортных средств на изображениях с использованием предобученных нейронных сетей из библиотеки OpenCV. Поддерживаются модели YOLO и SSD.

## Описание реализованных моделей
### Модель 1: YOLO (You Only Look Once)
Алгоритм предварительной обработки изображений
1) Нормализация значений пикселей

* Значения пикселей масштабируются из диапазона [0, 255] в диапазон [0, 1] с использованием коэффициента 1/255.0

2) Изменение размера изображения

* Исходное изображение изменяется до фиксированного размера 416×416 пикселей

* Сохраняются пропорции изображения без обрезки (crop=False)

3) Конвертация цветового пространства

* Выполняется преобразование из BGR в RGB (swapRB=True)

* Обеспечивается совместимость с ожидаемым форматом входных данных модели

4) Создание blob-объекта

* Формируется 4-мерный тензор с размерностью (1, 3, 416, 416)

* Подготовка данных для прямого прохода через нейронную сеть

Алгоритм обработки выхода сети
1) Извлечение детекций из выходных тензоров

* Обработка выходных данных от трех различных масштабов (3 output layers)

* Каждый тензор содержит информацию о bounding boxes, уверенности и классах

2) Фильтрация по порогу уверенности

* Отбрасывание детекций с уверенностью ниже установленного порога (по умолчанию 0.5)

* Сохранение только надежных предсказаний

3) Масштабирование координат bounding boxes

* Преобразование нормализованных координат к исходному размеру изображения

* Расчет абсолютных координат в пикселях

4) Применение Non-Maximum Suppression (NMS)

* Устранение дублирующих bounding boxes

* Подавление перекрывающихся детекций с меньшей уверенностью

* Использование порога NMS 0.4 по умолчанию

5) Формирование финальных детекций

* Структурирование результатов в формате: класс, уверенность, координаты bounding box

* Сопоставление идентификаторов классов с их текстовыми названиями

### Модель 2: SSD (Single Shot MultiBox Detector)
Алгоритм предварительной обработки изображений
1) Изменение размера изображения

* Исходное изображение изменяется до фиксированного размера 300×300 пикселей

* Стандартный размер входа для SSD моделей

2) Нормализация значений пикселей

* Вычитание средних значений (127.5, 127.5, 127.5) из каждого канала

* Центрирование данных вокруг нуля

3) Конвертация цветового пространства

* Преобразование из BGR в RGB (swapRB=True)

* Обеспечение соответствия с ожидаемым форматом входных данных

4) Создание blob-объекта

* Формирование 4-мерного тензора с размерностью (1, 3, 300, 300)

* Подготовка данных для передачи в нейронную сеть

Алгоритм обработки выхода сети
1) Парсинг выходного тензора

* Извлечение детекций из первого выходного тензора (outputs[0][0])

* Каждая детекция содержит: [batch_id, class_id, confidence, x1, y1, x2, y2]

2) Фильтрация по порогу уверенности

* Отсеивание детекций с уверенностью ниже установленного порога

* Сохранение только статистически значимых предсказаний

3) Масштабирование координат

* Преобразование нормализованных координат к исходным размерам изображения

* Расчет абсолютных позиций bounding boxes в пикселях

4) Преобразование формата координат

* Конвертация из формата (x, y, width, height) в (x1, y1, x2, y2)

* Упрощение последующей обработки и визуализации

5) Применение Non-Maximum Suppression

* Удаление дублирующих детекций

* Сохранение только наиболее уверенных bounding boxes для каждого объекта

6) Формирование результатов

* Структурирование выходных данных с информацией о классе, уверенности и координатах

* Сопоставление численных идентификаторов классов с текстовыми метками

### Метрики качества
* TPR (True Positive Rate): Доля правильно обнаруженных объектов от общего числа объектов в ground truth

* FDR (False Discovery Rate): Доля ложных срабатываний от общего числа детекций

### Структура проекта
* main.py - Основной скрипт для запуска приложения

* detector.py - Главный класс детектора транспортных средств

* models/ - Пакет с реализациями различных детекторов

* utils.py - Вспомогательные функции

* requirements.txt - Список зависимостей