## Практическая работа №2. Детектирование объектов на изображениях с использованием библиотеки OpenCV
В данной работе представлена реализация приложения для детектирования объектов с использованием обученной
нейронной сети YOLOv4.
## Предварительная обработка изображений
Перед тем, как подать нейронной сети изображение для детектирования объектов, нужно выполнить некоторые преобразования в соответствии с требованиями к входным данным для сети YOLOv4. 
В функции *image_processing* преобразование изображения в новый формат включает в себя:
- Нормализацию значений пикселей к диапазону от 0 до 1.
- Изменение размера изображения до 416x416 пикселей.
- Параметр указывающий, что нужно сохранять соотношение сторон изображения.
## Обработка выхода сети
**Алгоритм обработки предсказаний**

Для обработки выхода сети и вывода результатов написана функция *detect_and_display_objects*. В ней осуществляется итерация по всем выходным слоям, в каждом из которых перебираются предсказания. Затем 
выбирается класс с наивысшим значением вероятности принадлежности и происходит 
фильтрация предсказаний по порогу уверенности, значение которого равно 0.5, но может быть изменено. Для предсказаний, прошедших порог, сохраняются координаты ограничивающей рамки для детектируемых объектов, 
вероятность того, что обнаруженный объект действительно принадлежит к предсказанному классу, и индекс предсказанного класса объекта. После получения всех предсказаний, прошедших порог, выполняется удаление 
дублирующих обнаружений с помощью *cv.dnn.NMSBoxes*, где значение переменной *nms_threshold* равно 0.4, но оно также может быть изменено. Затем выполняется отображение результатов на исходном изображении.

**Метод для визуализации, полученных предсказаний**

В функции *draw_predictions* добавляется прямоугольник, цвет которого соответствует классу объекта, ограниченного данным прямоугольником, в левом верхнем углу каждого прямоугольника добавлено название класса и 
достоверность наличия объекта. Также сохраняется количество объектов каждого класса для вывода статистики.

## Детектирование объектов на видео

После загрузки видео запускается цикл обработки кадров, в котором для каждого кадра аналогично случаю с изображением вызываются методы для детектирования объектов.
