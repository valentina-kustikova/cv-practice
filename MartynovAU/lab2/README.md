# Практическая работа №2. Детектирование объектов на изображениях с использованием библиотеки OpenCV

## Описание

Лабораторная демонстрирует использование библиотеки OpenCV и модели YOLOv4 для детектирования объектов на изображениях и видео. Реализованы алгоритмы предварительной обработки изображений, обработки выходных данных сети и визуализации результатов. Скрипт поддерживает два режима работы: обработка одиночных изображений и покадровая обработка видео.

## Алгоритмы

### Предварительная обработка изображений
1. Изменение масштаба изображения: Используется функция cv.dnn.blobFromImage для нормализации и изменения размера изображения до 416x416(стандартный размер входа для YOLOv4).
2. Формирование входного blob: Изображение нормализуется в диапазоне [0, 1], каналы меняются местами (RGB → BGR), и изображение подается в модель.

### Обработка выхода сети
1. Получение выходов модели. Выполняется прямой проход через сеть (net.forward), используя выходные слои YOLO. Для каждого выхода извлекаются вероятности классов, координаты объектов и уровень их уверенности.
2. Фильтрация по порогу уверенности. Объекты с вероятностью ниже заданного порога, который можно задать пользователю, отбрасываются.
3. Non-Maximum Suppression (NMS). Алгоритм NMS используется для удаления пересекающихся ограничивающих рамок с более низкой уверенностью, основываясь на пороге nms_threshold.

### Визуализация
1. Отрисовка рамок. Каждому объекту назначается уникальный цвет на основе его класса (цвета определяются случайным образом). На изображение накладываются рамки, отображается имя класса и уровень уверенности.
2. Показ статистики. В режиме обработки изображений и видео отображается количество обнаруженных объектов каждого класса.

### Структура проекта

- lab2.py: Основной скрипт для выполнения детектирования.
- для запуска YOLOv4-модели необходимо наличие следующих файлов:
  - models/yolov4.cfg: Конфигурационный файл.
  - models/yolov4.weights: Весовые коэффициенты модели(необходимо учитывать разрешение фреймов, на которых натренирована модель)
  - models/coco.names: Список классов объектов (COCO dataset)
  - файл видео или формата .jpg

