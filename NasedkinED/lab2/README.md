# Практическая работа №2. Детектирование объектов на изображениях с использованием библиотеки OpenCV

## Реализованные модели и особенности обработки

### 1. MobileNet-SSD

- **Вход:** 300×300, масштаб `0.007843`, среднее `(127.5, 127.5, 127.5)`
- **Выход сети:** `[1, 1, N, 7]` → `[batch, class_id, confidence, x1_norm, y1_norm, x2_norm, y2_norm]`
- **Постобработка:** извлечение через `out[0,0,:,:]`, фильтрация по `confidence > 0.2`
- **Отслеживаемые классы:** `car`, `bus`, `motorbike`, `bicycle`, `train`

### 2. YOLOv8n (ONNX)

- **Вход:** 640×640, нормализация `1/255.0`, `swapRB=True`
- **Выход сети:** `[1, 84, 8400]` → после `squeeze().T` → `[8400, 84]`
- **Постобработка:**
    - Преобразование из `(cx, cy, w, h)` в `(x1, y1, x2, y2)`
    - Масштабирование координат под размер исходного кадра
    - Фильтрация по `confidence > 0.4`
    - Non-Maximum Suppression (`iou_threshold = 0.45`)
    - Универсальная обработка результата `cv2.dnn.NMSBoxes` (поддержка старых и новых версий OpenCV)
- **Отслеживаемые классы:** `car`, `bus`, `truck`, `motorcycle`, `bicycle`

## Результаты на видео mov03478 (3408 размеченных кадров)

| Модель            | Global TPR | Global FDR | Примечание                                                                      |
|-------------------|------------|------------|---------------------------------------------------------------------------------|
| **MobileNet-SSD** | **0.8503** | **0.0600** | Отличный баланс качества и скорости, минимальное количество ложных срабатываний |
| **YOLOv8n**       | **0.8184** | **0.1654** | Современная модель, высокая чувствительность к мелким объектам, чуть больше FP  |

MobileNet-SSD показал лучший результат по FDR благодаря строгой фильтрации и меньшему количеству избыточных детекций.  
YOLOv8n демонстрирует высокую обобщающую способность и уверенно детектирует объекты даже в сложных условиях (перекрытия,
мелкие машины в конце видео).

## Запуск

```bash
# MobileNet-SSD
python main.py frames mov03478.txt --model ssd --vis

# YOLOv8n (ONNX)
python main.py frames mov03478.txt --model yolov8 --vis