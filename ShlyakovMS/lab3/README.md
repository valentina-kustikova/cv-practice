# Практическая работа №3. Классификация изображений с использованием библиотеки OpenCV

## Описание работы
В рамках третьей лабораторной работы по дисциплине "Компьютерное зрение" реализована классификация изображений трех достопримечательностей Нижнего Новгорода: Нижегородского Кремля, Дворца Труда и Архангельского собора. Применены два алгоритма: Bag-of-Visual-Words (BoW) с использованием дескрипторов SIFT и классификатора SVM, а также метод трансферного обучения на базе сверточной нейронной сети ResNet50.

Работа выполнена на языке Python с использованием библиотек OpenCV, scikit-learn и PyTorch.  

## Структура проекта
- `src/dataset.py` — модуль загрузки и предобработки данных.
- `src/bow_classifier.py` — реализация BoW + SVM.
- `src/cnn_classifier.py` — реализация CNN на базе ResNet50.
- `main.py` — основной исполняемый скрипт.
- `data/` — директория с изображениями и файлами разметки `train.txt`, `test.txt`.
- `bow_visualizations/` — директория с результатами визуализации (генерируется автоматически).

## Реализованные алгоритмы

### 1. Загрузка данных (`src/dataset.py`)
Функция `load_images_from_list` осуществляет чтение списка путей из текстовых файлов разметки. Класс объекта определяется по имени содержащей его папки (соответствие задано словарем). Изображения загружаются с помощью `cv2.imread`, проверяется их целостность. Выполняется ресайз до размера 224×224 пикселей и преобразование цветового пространства BGR → RGB. Результат — массивы `numpy` с изображениями и метками классов.

### 2. Классификатор BoW + SVM (`src/bow_classifier.py`)
Класс `BoWClassifier` реализует следующие этапы:
- Извлечение дескрипторов SIFT (`cv2.SIFT_create`).
- Построение визуального словаря размером `k` с помощью `MiniBatchKMeans`.
- Формирование нормированных гистограмм частот визуальных слов для каждого изображения.
- Обучение SVM с RBF-ядром (`sklearn.svm.SVC`).

### 3. Классификатор на базе CNN (`src/cnn_classifier.py`)
Класс `TransferLearningClassifier` использует предобученную модель ResNet50 (`torchvision.models.resnet50`). Все слои замораживаются, заменяется только полносвязный слой (`fc`) на `nn.Linear(2048, 3)`. Обучение проводится только этого слоя с оптимизатором Adam (lr=0.001) и функцией потерь CrossEntropyLoss.

### 4. Визуализация BoW
В `main.py` реализована функция `visualize_bow_beautifully`, отображающая по одному корректно классифицированному примеру на каждый класс. Ключевые точки, соответствующие топ-5 визуальным словам, отмечаются цветными кружками. Легенда с частотами слов размещается в углу изображения.

## Результаты экспериментов
Тестирование проводилось на выборке из 88 изображений.

BoW + SVM Accuracy: 90.9091%

                     precision    recall  f1-score   support

             Кремль       0.84      0.97      0.90        39
       Дворец труда       1.00      0.90      0.95        29
       Архангельский собор       0.94      0.80      0.86        20

           accuracy                           0.91        88
          macro avg       0.93      0.89      0.91        88
       weighted avg       0.92      0.91      0.91        88

CNN Accuracy: 98.8636%

                     precision    recall  f1-score   support

             Кремль       0.97      1.00      0.99        39
       Дворец труда       1.00      1.00      1.00        29
       Архангельский собор       1.00      0.95      0.97        20

           accuracy                           0.99        88
          macro avg       0.99      0.98      0.99        88
       weighted avg       0.99      0.99      0.99        88

