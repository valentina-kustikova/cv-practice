# Практическая работа №2. Детектирование объектов на изображениях с использованием библиотеки OpenCV

## Описание работы

В данной работе реализовано приложение для детектирования объектов на изображениях и видео с использованием предобученной нейронной сети YOLOv3. Приложение использует библиотеку OpenCV и её модуль DNN (Deep Neural Networks) для работы с нейронными сетями.

### Основные функции:
1. **Детектирование объектов на изображении**:
   - Загрузка изображения.
   - Предварительная обработка изображения для подачи в нейронную сеть.
   - Анализ выходов нейронной сети.
   - Применение немаксимального подавления (NMS) для устранения дублирующихся обнаружений.
   - Отрисовка прямоугольников вокруг обнаруженных объектов с указанием класса и достоверности.

2. **Детектирование объектов на видео**:
   - Обработка видеофайла кадр за кадром.
   - Детектирование объектов на каждом кадре.
   - Отображение результатов в реальном времени.

### Используемые файлы:
- `yolov3.cfg`: Конфигурационный файл YOLOv3.
- `yolov3.weights`: Веса предобученной модели YOLOv3.
- `coco.names`: Список классов объектов, которые может детектировать YOLOv3.

## Алгоритмы предварительной обработки и обработки выхода сети

### 1. Предварительная обработка изображения:
- Изображение преобразуется в формат, подходящий для нейронной сети, с помощью функции `cv2.dnn.blobFromImage`.
- Параметры:
  - `scale=0.00392`: Коэффициент масштабирования (1/255).
  - `size=(416, 416)`: Размер изображения, который ожидает нейронная сеть.
  - `mean=(0, 0, 0)`: Значения, которые вычитаются из каждого канала (в данном случае не используются).
  - `swapRB=True`: Переключение каналов с BGR на RGB.
  - `crop=False`: Изображение не обрезается.

### 2. Обработка выхода сети:
- Выходы нейронной сети содержат информацию о вероятностях принадлежности объектов к различным классам.
- Для каждого обнаруженного объекта:
  - Определяется класс объекта с максимальной вероятностью.
  - Если вероятность превышает заданный порог (`confidence_threshold`), объект считается обнаруженным.
  - Координаты объекта масштабируются обратно к исходным размерам изображения.

### 3. Немаксимальное подавление (NMS):
- Используется для устранения дублирующихся обнаружений одного и того же объекта.
- Алгоритм выбирает обнаружение с наивысшей достоверностью и удаляет все остальные обнаружения, которые перекрываются с ним выше заданного порога (`nms_threshold`).

### 4. Отрисовка результатов:
- Для каждого обнаруженного объекта на изображении рисуется прямоугольник.
- В левом верхнем углу прямоугольника отображается название класса и достоверность обнаружения с точностью до трёх знаков после запятой.

## Инструкция по запуску

Параметры

--image: Путь к изображению для детектирования.

--video: Путь к видеофайлу для детектирования.

--confidence: Порог уверенности для фильтрации обнаружений (по умолчанию 0.5).

--nms: Порог для немаксимального подавления (по умолчанию 0.4).

### Пример запуска

python script.py --image path/to/image.jpg -c 0.6 -n 0.3
