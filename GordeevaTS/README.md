# Лабораторная работа №3. Классификация изображений с использованием библиотеки OpenCV

## Постановка задачи

**Цель работы** — разработать приложение для классификации изображений достопримечательностей Нижнего Новгорода и сравнить два подхода:
 - Классический метод «мешка визуальных слов» (Bag of Visual Words)
 - Нейросетевой подход с извлечением признаков и классическими ML-алгоритмами

**Классы для классификации:**
 - Нижегородский Кремль
 - Дворец труда
 - Архангельский собор


## Методы, их преимущества и недостатки
**Bag of Visual Words**

Метод "Мешка визуальных слов" представляет собой классический подход компьютерного зрения, основанный на аналогии с 
текстовым анализом. Сначала алгоритмы SIFT или ORB находят на изображениях ключевые точки: углы и характерные области, 
устойчивые к изменениям масштаба и поворота. Для каждой точки вычисляется числовой дескриптор, описывающий её окружение. 
Все дескрипторы со всех изображений группируются в кластеры методом K-means, создавая "визуальный словарь". Каждое 
изображение затем преобразуется в гистограмму, показывающую частоту использования каждого "слова" из словаря. Эти 
гистограммы служат основой для обучения SVM-классификатора.

*Преимущества:*
 - Инвариантность к масштабу и повороту
 - Хорошая интерпретируемость
 - Не требует GPU
 - Эффективен на небольших датасетах

*Недостатки:*
 - Не учитывает пространственные связи
 - Требует ручного выбора детектора
 - Меньшая точность по сравнению с глубокими сетями

**Нейросетевые признаки**

Этот подход комбинирует несколько типов hand-crafted признаков с классическими алгоритмами машинного обучения. Из каждого 
изображения извлекаются: гистограмма ориентированных градиентов (HOG), описывающая форму объектов; локальные бинарные 
паттерны (LBP), кодирующие текстуру; цветовые статистики и градиенты Собеля для выделения контуров. Все эти признаки 
объединяются в единый вектор, который подается на вход классификаторам Random Forest.Классификатор работает как ансамбль 
деревьев, обеспечивая устойчивость к переобучению. Метод не требует GPU и демонстрирует высокую точность за счет комплексного описания 
изображений через различные аспекты визуальной информации.



*Преимущества:*
 - Автоматическое извлечение признаков
 - Хорошая точность
 - Не требует глубоких нейросетей

*Недостатки:*
 - Ограниченный набор признаков
 - Зависимость от качества feature engineering


## Архитектура решения
### 1) BoW (Bag of Words - Мешок слов)

**Этапы работы:**
1. Детектирование ключевых точек: SIFT-детекторы
2. Извлечение дескрипторов: 128-мерные векторы признаков
3. Построение словаря: K-means кластеризация
4. Векторизация: гистограммы визуальных слов
5. Классификация: SVM с линейным ядром

### 2) NN (Нейросетевые признаки + классификаторы)

**Этапы работы:**
1. Извлечение признаков → HOG + LBP + цветовые статистики
2. Классификация → Random Forest

## Использование программы
**Базовые параметры:**
 - `--data_path`: Путь к директории с данными
 - `--train_split`: Файл с тренировочной выборкой
 - `--test_split`: Файл с тестовой выборкой
 - `--algorithm {bow|nn}`: Выбор алгоритма
 - `--mode {train|test|both}`: Режим работы

**Запуск Bag of Words:**
```
# Обучение и тестирование
python main.py --data_path ./data --train_split data/train.txt --test_split data/test.txt --algorithm bow --detector SIFT --vocab_size 100

# Только тестирование
python main.py --data_path ./data --train_split data/train.txt --test_split data/test.txt --algorithm bow --mode test

# Только тестирование (при сохраненной модели)
python main.py --data_path ./data --train_split data/train.txt --test_split data/test.txt --algorithm bow --mode test --model_name bow_SIFT_vocab50_20251116_212520
```

**Запуск нейросетевого классификатора:**
```
# Обучение и тестирование
python main.py --data_path ./data --train_split train.txt --test_split test.txt --algorithm nn --classifier RandomForest --vocab_size 100

# Только тестирование
python main.py --data_path ./data --train_split data/train.txt --test_split data/test.txt --algorithm nn --classifier RandomForest

# Только тестирование (при сохраненной модели)
python main.py --data_path ./data --train_split data/train.txt --test_split data/test.txt --algorithm nn --mode test --model_name nn_RandomForest_20251116_213604
```

## Сравнение методов
|Метод|Точность|
|---|---|
|Bag of Visual Words |**0.8864**|
|Transfer Learning (CNN)|**0.9545**|


## Выводы и результаты
**В ходе работы было выполнено следующее:**
 - Реализован метод мешка визуальных слов для классификации изображений
 -  Реализован нейросетевой подход с извлечением признаков
 - Проведено сравнение эффективности методов

**Основные выводы**
 - BoVW демонстрирует хорошие результаты на ограниченных данных
 - Нейросетевые признаки обеспечивают конкурентную точность без использования глубоких сетей
 - Оба подхода эффективны для задачи классификации архитектурных объектов
